name: Auto Review & Fix

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  auto-review:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.ref }}
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Review & Comment
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          PR_NUMBER: ${{ github.event.pull_request.number }}
        run: |
          echo "ğŸ”„ Starting auto-review process..."
          
          # Request Copilot review via PR comment
          echo "ğŸ“ Requesting Copilot review..."
          gh pr review $PR_NUMBER --comment -b "ğŸ¤– @copilot, please review this PR for any critical issues, bugs, security concerns, or improvements. Focus on:
          - Code quality and best practices
          - Potential bugs or logic errors
          - Security vulnerabilities
          - Performance issues
          - Flutter/Dart specific concerns"
          
          # Wait for review to be posted
          echo "â³ Waiting for Copilot review..."
          sleep 30
          
          # Add success comment
          gh pr comment $PR_NUMBER --body "âœ… **Otomatik review tamamlandÄ±!** 
          
Copilot review isteÄŸi gÃ¶nderildi. Review tamamlandÄ±ktan sonra:
- Kritik sorunlar varsa, bunlarÄ± dÃ¼zeltip tekrar push edin
- Sorun yoksa PR'Ä± merge edebilirsiniz

**Not:** Bu otomatik bir mesajdÄ±r. Copilot review'Ã¼nÃ¼ yukarÄ±da kontrol edin. ğŸš€"
